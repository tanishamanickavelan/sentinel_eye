<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sentinel Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .btn-status {
            min-width: 90px;
            font-weight: bold;
        }
        .badge-status {
            font-size: 0.9em;
        }
        .video-player {
            max-width: 300px;
            height: auto;
        }
    </style>
</head>
<body class="bg-light">
<div class="container mt-5">
    <h1 class="mb-4">Sentinel Eye Alerts</h1>
    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Timestamp</th>
                <th>Confidence</th>
                <th>Clip</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
        {% for alert in alerts %}
            <tr>
                <td>{{ alert.id }}</td>
                <td>{{ alert.timestamp }}</td>
                <td>{{ "%.2f"|format(alert.confidence) }}</td>
                <td>
                    <video class="video-player" controls>
                        <source src="{{ alert.clip_url }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </td>
                <td>
                    <span class="badge 
                        {% if alert.status=='BAD' %}bg-danger
                        {% elif alert.status=='GOOD' %}bg-success
                        {% else %}bg-secondary{% endif %} badge-status">
                        {{ alert.status }}
                    </span>
                </td>
                <td>
                    <form method="POST" action="{{ url_for('update_status') }}" class="d-flex gap-1">
                        <input type="hidden" name="id" value="{{ alert.id }}">
                        <input type="text" name="notes" class="form-control form-control-sm" placeholder="Add note">
                        <button type="submit" name="action" value="confirm" class="btn btn-sm btn-danger btn-status">BAD</button>
                        <button type="submit" name="action" value="dismiss" class="btn btn-sm btn-success btn-status">GOOD</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
